<div class="row">
    <div class="col-xl-12">
        <app-card cardTitle="Liste des Categories" blockClass="table-border-style">
            <div class="row">
                <div class="col-md-6">
                    <button type="button" style="margin-top: -25px;" class="btn btn-outline-primary"
                        data-bs-toggle="modal" data-bs-target="#addCategory" (click)="toggleAddModal()">
                        Ajouter Categorie
                    </button>
                </div>
                <div class="col-md-6" style="margin-top: -1%;" *ngIf="searchForm">
                    <form [formGroup]="searchForm" class="d-flex">
                        <input type="text" formControlName="name" class="form-control me-2"
                            placeholder="Chercher Categorie" aria-label="Search" (input)="getCategoriesByName()">
                    </form>
                </div>
            </div>

            <div class="table-responsive" style="margin-top: 1;">
                <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
                    <ng-container matColumnDef="position">
                        <th mat-header-cell *matHeaderCellDef>#</th>
                        <td mat-cell *matCellDef="let element; let i = index">{{i + 1}}</td>
                    </ng-container>
                    <ng-container matColumnDef="name">
                        <th mat-header-cell *matHeaderCellDef>Nom</th>
                        <td mat-cell *matCellDef="let element">{{element.name}}</td>
                    </ng-container>
                    <ng-container matColumnDef="description">
                        <th mat-header-cell *matHeaderCellDef>Description</th>
                        <td mat-cell *matCellDef="let element">{{element.description}}</td>
                    </ng-container>
                    <ng-container matColumnDef="nbArticles">
                        <th mat-header-cell *matHeaderCellDef>Nombre Articles</th>
                        <td mat-cell *matCellDef="let element">{{element.nbArticles}}</td>
                    </ng-container>
                    <ng-container matColumnDef="actions">
                        <th mat-header-cell *matHeaderCellDef>Actions</th>
                        <td mat-cell *matCellDef="let element">
                            <button data-bs-toggle="modal" data-bs-target="#updateCategory"
                                (click)="editCategory(element)" type="button"
                                class="btn btn-icon btn-warning text-dark d-inline-flex m-1">
                                <i class="feather icon-edit"></i>
                            </button>
                            <button data-bs-toggle="modal" data-bs-target="#deleteCategory" type="button"
                                (click)="deleteCategoryStore(element)"
                                class="btn btn-icon btn-danger d-inline-flex m-1">
                                <i class="feather icon-trash"></i>
                            </button>
                            <button type="button" routerLink="/categorie/{{element.id}}/articles"
                                class="btn btn-icon btn-info d-inline-flex">
                                <i class="feather icon-info"></i>
                            </button>
                        </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                </table>
                <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
                <!-- add category modal form -->
                <div class="modal fade" id="addCategory" tabindex="-1" aria-labelledby="exampleModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content" *ngIf="addCategoryForm">
                            <form [formGroup]="addCategoryForm" action="javascript:" class="was-validated"
                                (submit)="ajouterCategorie()">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Ajouter Une Nouvelle Categorie</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="mb-3">
                                        <label for="validationTextarea" class="form-label">Nom</label>
                                        <input formControlName="name" class="form-control is-invalid" required
                                            id="validationTextarea" placeholder="Nom De La Categorie" />
                                        <div class="invalid-feedback" *ngIf="addCategoryForm.get('name')?.invalid">
                                            Veuillez Entrer Un Nom !</div>
                                    </div>

                                    <div class="mb-3">
                                        <label for="validationDescription" class="form-label">Description</label>
                                        <input formControlName="description" class="form-control is-invalid" required
                                            id="validationDescription" placeholder="Description De La Categorie" />
                                        <div class="invalid-feedback"
                                            *ngIf="addCategoryForm.get('description')?.invalid">Veuillez Entrer Une
                                            Description !</div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Ferner</button>
                                    <button type="submit" class="btn btn-primary">Ajouter</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!-- update category modal form -->
                <div class="modal fade" id="updateCategory" tabindex="-1" aria-labelledby="exampleModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content" *ngIf="updateCategoryForm">
                            <form [formGroup]="updateCategoryForm" (submit)="updateCategory()" action="javascript:"
                                class="was-validated">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Modifier Categorie</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                        aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <input type="hidden" formArrayName="id">
                                    <div class="mb-3">
                                        <label for="validationTextarea" class="form-label">Nom</label>
                                        <input formControlName="name" class="form-control is-invalid" required
                                            id="validationTextarea" placeholder="Nom De La Categorie" />
                                        <div class="invalid-feedback" *ngIf="updateCategoryForm.get('name')?.invalid">
                                            Veuillez Entrer Un Nom !</div>
                                    </div>

                                    <div class="mb-3">
                                        <label for="validationDescription" class="form-label">Description</label>
                                        <input formControlName="description" class="form-control is-invalid" required
                                            id="validationDescription" placeholder="Description De La Categorie" />
                                        <div class="invalid-feedback"
                                            *ngIf="updateCategoryForm.get('description')?.invalid">Veuillez Entrer Une
                                            Description !</div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Fermer</button>
                                    <button type="submit" class="btn btn-primary">Modifier</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!-- delete category modal  -->
                <div class="modal fade" id="deleteCategory" tabindex="-1" aria-labelledby="exampleModalLabel"
                    aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Supprimer Categorie</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div class="mb-3">
                                    <p style="color: red; font-size: larger;">Veuillez Confirmer la Suppression !</p>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" #closeButton
                                    data-bs-dismiss="modal">Annuler</button>
                                <button type="button" class="btn btn-danger"
                                    (click)="deleteCategory()">Supprimer</button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </app-card>
    </div>
</div>